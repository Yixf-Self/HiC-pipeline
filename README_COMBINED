The pipeline performs Fit-hi-c analysis at RE-size window resolution. The pipeline consists of two pipelines:  mappingHiC-pipeline_COMBINED and hic_flexible_COMBINED
 

In mappingHiC-pipeline_COMBINED:
Assumes there are folders named HiC_R?_NAME with R?=replicate number in data folder (here :/srv/gsfs0/projects/kundaje/users/mtaranov/projects/dynamic3D/rawReads). Each folder contains two separate fq.gz files named HiC_R2_D3_1.fq.gz  HiC_R?_NAME_2.fq.gz with two HiC ends respectively.

runall: This script calls all the other steps below in mapping/filtering pipeline
pipeline: This script defines all the variables and a step to be run with runall
step1_align: Align the reads using BWA to the reference genome. You will need the appropriate BWA index file.
step2_sort: Filter for number of mismatches, mapping quality and unique mapping. 
step3_joinAllCombinations: Take a join of the separately mapped XYZ_1.fq.gz and XYZ_2.fq.gz files to get paired reads.
step3_removePCRdups: Remove the read pairs that map to exactly same coordinates (both ends). Keep only one pair out of many copies.


hic_flexible_COMBINED:

- Assumes there are read pairs under the cleanedPairs folders: HiC_NAME_R? folders with HiC_NAME_R?_cleanedPairs.gz file in cleanedPairs (here: /srv/gsfs0/projects/kundaje/users/mtaranov/projects/dynamic3D/FIT-HI-C/mappingHiC-pipeline_COMBINED/data/cleanedPairs) generated by mappingHiC-pipeline_COMBINED.
- Assumes there is hic_flexible_COMBINED/ data/reference_genomes/hg19 folder with chromosome length and HindIII fragmens files

The pipeline assignes contacts to RE size windowing. Process genome for mappability. Then, the normalization using ICE and applying Fit-Hi-C.

Allows analyzing separate replicates or replicates combined. 

    In pipeline:
    runall: This script calls all the other steps below

    In bin:
    step2_get-contactCounts-atRESize: get contacts at RE-window size
    step2a_ScatterContactCounts: plot raw contact counts as function of distance
    step3_preprocess_for_bias_pipeline.sh: preprocess the genome to get mappability per window. Note: needs to be run only once for a particular resolution.
    step4_sparseICEnormalize: normalizes each library using sparse ICE implementation amd calculate biases for each window.
    step4a: plots distribution of IC biases 
    step5-ContactsPerFragment: calculate total numbmer of contacts coming out of each window
    step6_fithic: perform fit-hic on data before and after ICE.
 

     



